<mat-card>
  <mat-card-header>
    <mat-card-title>Missions</mat-card-title>
    <mat-card-subtitle>{{ currentDate }}</mat-card-subtitle>
  </mat-card-header>
  <mat-card-content>
    <table mat-table [dataSource]="missions">
      <ng-container matColumnDef="missionId">
        <th mat-header-cell *matHeaderCellDef>Id Mission</th>
        <td mat-cell *matCellDef="let mission"><b>#{{ mission.missionId }}</b></td>
      </ng-container>

      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef>Date</th>
        <td mat-cell *matCellDef="let mission">
          {{ mission.date | date }}
        </td>
      </ng-container>

      <ng-container matColumnDef="time">
        <th mat-header-cell *matHeaderCellDef>Heure</th>
        <td mat-cell *matCellDef="let mission">{{ mission.time }}</td>
      </ng-container>

      <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef>Type</th>
        <td mat-cell *matCellDef="let mission" [ngClass]="mission.type == 'Erreur' ? 'error-type' : ''">{{ mission.type }}</td>
      </ng-container>

      <ng-container matColumnDef="robots">
        <th mat-header-cell *matHeaderCellDef> Robots </th>
        <td mat-cell *matCellDef="let mission">
          <ng-container *ngIf="mission.robots.length > 0; else noRobots">
            <span *ngFor="let robot of mission.robots" [ngClass]="getRobotColor(robot)" class="robot-capsule">
              {{ robot }}
            </span>
          </ng-container>
          <ng-template #noRobots>
            <span class="no-robots">Aucun robots</span>
          </ng-template>
        </td>
    </ng-container>    

      <ng-container *ngIf="showOptions" matColumnDef="options">
        <th mat-header-cell *matHeaderCellDef class="align-right"> Options </th>
        <td mat-cell *matCellDef="let mission" class="align-right">
          <button mat-icon-button [matMenuTriggerFor]="menu" (click)="$event.stopPropagation()">
            <mat-icon>more_vert</mat-icon>
          </button>
          <mat-menu #menu="matMenu">
            <button mat-menu-item (click)="openMissionInfo(mission.missionId)">
              <mat-icon>visibility</mat-icon>
              <span>Voir les d√©tails</span>
            </button>
            <button mat-menu-item (click)="deleteMission(mission.missionId)">
              <mat-icon color="warn">delete</mat-icon>
              <span style="color: #f44336;">Supprimer</span>
            </button>
          </mat-menu>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="openMissionInfo(row.missionId)"></tr>
    </table>
  </mat-card-content>
</mat-card>